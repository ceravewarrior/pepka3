<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Dynamiczne Tło 3D</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            overflow: hidden;
            background: linear-gradient(135deg, #1a1a2e, #16213e, #0f3460);
            height: 100vh;
            transition: 
                background 1s ease-out,
                transform 0.1s linear;
            touch-action: none;
            font-family: 'Segoe UI', Tahoma, sans-serif;
        }
    </style>
</head>
<body>
    <script>
        // Parametry kontrolujące czułość
        const SENSITIVITY = {
            hue: 0.8,
            saturation: 0.3,
            lightness: 0.2,
            angle: 0.5
        };

        // Stan czujników
        let deviceOrientation = {
            beta: 0,
            gamma: 0,
            angle: 135
        };

        // Funkcja aktualizująca tło
        function updateBackground() {
            const h = (Math.abs(
                deviceOrientation.beta * SENSITIVITY.hue + 
                deviceOrientation.gamma * SENSITIVITY.hue * 2
            )) % 360;
            
            const s = 85 + Math.abs(deviceOrientation.gamma) * SENSITIVITY.saturation;
            const l = 20 + Math.abs(deviceOrientation.beta) * SENSITIVITY.lightness;
            
            // Dynamiczny kąt gradientu
            const angle = deviceOrientation.angle;
            
            // Trójwymiarowy gradient
            const color1 = `hsl(${h}, ${s}%, ${l}%)`;
            const color2 = `hsl(${(h + 120) % 360}, ${s}%, ${l + 8}%)`;
            const color3 = `hsl(${(h + 240) % 360}, ${s}%, ${l - 5}%)`;
            
            document.body.style.background = 
                `linear-gradient(${angle}deg, ${color1}, ${color2}, ${color3})`;
        }

        // Obsługa danych z żyroskopu
        function handleOrientation(event) {
            deviceOrientation.beta = event.beta || 0;
            deviceOrientation.gamma = event.gamma || 0;
            
            // Obliczanie kąta na podstawie ruchu
            const rawAngle = Math.atan2(
                deviceOrientation.gamma, 
                deviceOrientation.beta
            ) * 180 / Math.PI;
            
            // Normalizacja kąta (0-360)
            deviceOrientation.angle = (rawAngle + 360) % 360;
            
            updateBackground();
        }

        // Automatyczna aktywacja czujników
        async function initSensors() {
            try {
                if (typeof DeviceOrientationEvent.requestPermission === 'function') {
                    const permission = await DeviceOrientationEvent.requestPermission();
                    if (permission === 'granted') {
                        window.addEventListener('deviceorientation', handleOrientation);
                    }
                } else {
                    window.addEventListener('deviceorientation', handleOrientation);
                }
            } catch (error) {
                console.log("Aktywowano tryb animacji bez czujników");
            }
        }

        // Animacja wstępna
        function startBackgroundAnimation() {
            let hue = 0;
            let angle = 135;
            
            const animate = () => {
                hue = (hue + 0.3) % 360;
                angle = (angle + 0.2) % 360;
                
                const color = `hsl(${hue}, 85%, 20%)`;
                const color2 = `hsl(${(hue + 120) % 360}, 85%, 25%)`;
                const color3 = `hsl(${(hue + 240) % 360}, 85%, 15%)`;
                
                document.body.style.background = 
                    `linear-gradient(${angle}deg, ${color}, ${color2}, ${color3})`;
                
                requestAnimationFrame(animate);
            };
            
            animate();
        }

        // Inicjalizacja
        window.addEventListener('DOMContentLoaded', () => {
            startBackgroundAnimation();
            setTimeout(initSensors, 1000);
        });
    </script>
</body>
</html>